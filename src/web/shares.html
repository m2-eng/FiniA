<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FiniA - Aktien & Wertpapiere</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style id="dynamic-theme">/* Theme variables loaded from API */</style>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="theme.css">
</head>
<body>
  <div id="header-container"></div>
  <div class="container">
    <!-- Shares Table -->
    <div class="page-card">
      <div class="details-header">
        <div>
          <h3>Wertpapiere</h3>
          <p class="details-meta">Verwalten Sie Ihre Wertpapiere und Aktien.</p>
        </div>
      </div>
      <div class="search-bar" style="margin-bottom: 8px;">
        <input type="text" id="sharesSearchInput" placeholder="Suchen (Name, ISIN, WKN)">
      </div>
      <div class="details-toolbar" style="margin-bottom: 8px;">
        <button class="btn" id="refreshSharesBtn">Aktualisieren</button>
        <button class="btn" id="addShareBtn">+ Hinzufügen</button>
      </div>
      <div class="details-toolbar shares-filter-toggle" style="margin-bottom: 8px;">
        <button class="btn btn-secondary active" data-shares-filter="in_stock">Wertpapiere im Bestand</button>
        <button class="btn btn-secondary" data-shares-filter="all">Alle Wertpapiere</button>
        <button class="btn btn-secondary" data-shares-filter="incomplete">Unvollständig (Name/WKN fehlen)</button>
      </div>
      <div class="table-wrapper" style="overflow-x:auto;">
        <table id="sharesTable" class="simple-table" style="table-layout: fixed; width: 100%; border-collapse: collapse;">
          <colgroup>
            <col class="col-name" style="width: auto;">
            <col class="col-wkn" style="width: 80px;">
            <col class="col-isin" style="width: 120px;">
            <col class="col-anteile" style="width: 120px;">
            <col class="col-kurs" style="width: 156px;">
            <col class="col-gesamtwert" style="width: 156px;">
            <col class="col-investitionen" style="width: 156px;">
            <col class="col-ertrag" style="width: 156px;">
            <col class="col-saldo" style="width: 156px;">
            <col class="col-dividenden" style="width: 156px;">
            <col class="col-aktionen" style="width: 185px;">
          </colgroup>
          <thead>
            <tr>
              <th class="sortable col-name" data-sort="name">Name</th>
              <th class="sortable col-wkn" data-sort="wkn">WKN</th>
              <th class="sortable col-isin" data-sort="isin">ISIN</th>
              <th class="sortable col-anteile" data-sort="currentVolume" style="text-align: right;">Anteile</th>
              <th class="sortable col-kurs" data-sort="currentPrice" style="text-align: right;">Kurs</th>
              <th class="sortable col-gesamtwert" data-sort="portfolioValue" style="text-align: right;">Gesamtwert</th>
              <th class="sortable col-investitionen" data-sort="investments" style="text-align: right;">Investitionen</th>
              <th class="sortable col-ertrag" data-sort="proceeds" style="text-align: right;">Ertrag Verkauf</th>
              <th class="sortable col-saldo" data-sort="net" style="text-align: right;">Saldo</th>
              <th class="sortable col-dividenden" data-sort="dividends" style="text-align: right;">Dividenden</th>
              <th class="col-aktionen" style="text-align: center;">Aktionen</th>
            </tr>
          </thead>
          <tbody id="sharesTbody">
            <!-- Dynamisch geladen -->
          </tbody>
        </table>
      </div>
      <div class="pagination" id="sharesPagination"></div>
    </div>

    <!-- Transactions and History Tables Side by Side -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
      <!-- Transactions Table -->
      <div class="page-card">
        <div class="details-header">
          <div>
            <h3>Wertpapiertransaktionen</h3>
            <p class="details-meta">Alle Kauf- und Verkaufstransaktionen Ihrer Wertpapiere.</p>
          </div>
        </div>
        <div class="search-bar" style="margin-bottom: 8px;">
          <input type="text" id="transactionsSearchInput" placeholder="Suchen (Wertpapier, ISIN, WKN)">
        </div>
        <div class="details-toolbar" style="margin-bottom: 8px;">
          <button class="btn" id="refreshTransactionsBtn">Aktualisieren</button>
          <button class="btn" id="addTransactionBtn">+ Hinzufügen</button>
          <button class="btn" id="importTransactionsTableBtn">Importieren</button>
        </div>
        <div class="table-wrapper" style="overflow-x:auto;">
          <table id="transactionsTable" class="simple-table" style="table-layout: fixed; width: 100%; border-collapse: collapse;">
            <colgroup>
              <col class="col-datum" style="width: 100px;">
              <col class="col-isin" style="width: 120px;">
              <col class="col-wertpapier" style="width: auto;">
              <col class="col-betrag" style="width: 120px;">
              <col class="col-anteile" style="width: 120px;">
              <col class="col-aktionen" style="width: 185px;">
            </colgroup>
            <thead>
              <tr>
                <th class="sortable col-datum" data-sort="dateTransaction">Datum</th>
                <th class="sortable col-isin" data-sort="isin">ISIN</th>
                <th class="sortable col-wertpapier" data-sort="share_name">Wertpapier</th>
                <th class="sortable col-betrag" data-sort="accountingEntry_amount" style="text-align: right;">Betrag</th>
                <th class="sortable col-anteile" data-sort="tradingVolume" style="text-align: right;">Anteile</th>
                <th class="col-aktionen" style="text-align: center;">Aktionen</th>
              </tr>
            </thead>
            <tbody id="transactionsTbody">
              <!-- Dynamisch geladen -->
            </tbody>
          </table>
        </div>
        <div class="pagination" id="transactionsPagination"></div>
      </div>

      <!-- History Table -->
      <div class="page-card">
        <div class="details-header">
          <div>
            <h3>Wertpapierhistorie</h3>
            <p class="details-meta">Historische Kurse und Werte Ihrer Wertpapiere.</p>
          </div>
        </div>
        <div class="search-bar" style="margin-bottom: 8px;">
          <input type="text" id="historySearchInput" placeholder="Suchen (Name, ISIN, WKN)">
        </div>
        <div class="details-toolbar history-filter-toggle" style="margin-bottom: 8px;">
          <button class="btn btn-secondary active" data-history-filter="unchecked">Nur ungeprüfte</button>
          <button class="btn btn-secondary" data-history-filter="all">Alle Einträge</button>
        </div>
        <div class="details-toolbar" style="margin-bottom: 8px;">
          <button class="btn" id="refreshHistoryBtn">Aktualisieren</button>
          <button class="btn" id="addHistoryBtn">+ Hinzufügen</button>
          <button class="btn" id="importHistoryTableBtn">Importieren</button>
          <button class="btn" id="autoFillHistoryBtn">Fehlende Monatsenden ergänzen</button>
        </div>
        <div class="table-wrapper" style="overflow-x:auto;">
          <table id="historyTable" class="simple-table" style="table-layout: fixed; width: 100%; border-collapse: collapse;">
            <colgroup>
              <col style="width: 100px;" class="col-datum">
              <col style="width: auto;" class="col-wertpapier">
              <col style="width: 120px;" class="col-betrag">
              <col style="width: 120px;" class="col-geprueft">
              <col style="width: 257px;" class="col-aktionen">
            </colgroup>
            <thead>
              <tr>
                <th class="sortable col-datum" data-sort="date">Datum</th>
                <th class="sortable col-wertpapier" data-sort="share_name">Wertpapier</th>
                <th class="sortable col-betrag" data-sort="amount" style="text-align: right;">Betrag</th>
                <th class="col-geprueft" style="text-align: center;">Geprüft</th>
                <th class="col-aktionen" style="text-align: center;">Aktionen</th>
              </tr>
            </thead>
            <tbody id="historyTbody">
              <!-- Dynamisch geladen -->
            </tbody>
          </table>
        </div>
        <div class="pagination" id="historyPagination"></div>
      </div>
    </div>
    
  </div>

  <!-- Hidden file inputs for imports -->
  <input type="file" id="transactionsFileInput" accept=".csv" style="display: none;">
  <input type="file" id="historyFileInput" accept=".csv" style="display: none;">

  <!-- Generic modal for add forms -->
  <div id="formModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle"></h3>
        <button class="btn-ghost" id="modalCloseBtn" aria-label="Schließen">X</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
      <div class="modal-footer">
        <button class="btn-secondary" id="modalCancelBtn">Abbrechen</button>
        <button class="btn" id="modalSaveBtn">Speichern</button>
      </div>
    </div>
  </div>
  <script src="utils.js?v=10"></script>
  <script src="help_documents.js?v=10"></script>
  <script src="help.js?v=10"></script>
  <script src="app.js?v=10"></script>
  <script src="table_config.js?v=10"></script>
  <script src="table_engine.js?v=10"></script>
  <script src="shares.js?v=10"></script>
</body>
</html>
